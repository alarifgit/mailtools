<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>MailTools</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" href="/static/favicon.svg">
<link href="/static/styles.css?v=7" rel="stylesheet">
<script defer src="/static/ui.js"></script>
</head>
<body>
<header class="appbar">
  <div class="appbar-inner">
    <button class="hamburger" id="toggleSidebar" aria-label="Toggle sidebar">☰</button>
    <a class="brand" href="/">
      <span class="brand-icon">📧</span>
      <span>MailTools</span>
    </a>
    <form action="/dns" method="get" class="top-search" autocomplete="off">
      <input name="domain" type="text" placeholder="Quick domain check (example.com)">
      <button>Check</button>
    </form>
  </div>
</header>

<div class="layout">
  <aside class="sidebar" id="sidebar">
    <div class="sidebar-logo">
      <div class="sidebar-logo-icon">📧</div>
      <div class="sidebar-logo-text">MailTools</div>
    </div>

    <div class="side-section">
      <h4>TOOLS</h4>
      <a class="side-link" href="/dns">
        <span class="side-link-icon">🔍</span>
        <span>E-mail DNS Check</span>
      </a>
      <a class="side-link" href="/dig">
        <span class="side-link-icon">⚙️</span>
        <span>Dig</span>
      </a>
      <a class="side-link" href="/mha">
        <span class="side-link-icon">📋</span>
        <span>Message Header Analyzer</span>
      </a>
      <a class="side-link" href="/rbl">
        <span class="side-link-icon">🛡️</span>
        <span>RBL / Blacklist</span>
      </a>
    </div>

    <div class="side-section">
      <h4>RECENT CHECKS</h4>
      {% if recent_checks and recent_checks|length > 0 %}
        {% for check in recent_checks %}
        <a class="recent-item" href="{{ check.url }}">
          <div class="recent-item-content">
            <div class="recent-item-domain">{{ check.target }}</div>
            <div class="recent-item-meta">{{ check.tool|upper }} Check • {{ check.time_ago }}</div>
          </div>
          <div class="recent-item-check">✓</div>
        </a>
        {% endfor %}
        <button class="clear-history-btn" onclick="clearHistory()">Clear History</button>
      {% else %}
        <div style="padding: 10px; color: var(--text-muted); font-size: 0.8125rem;">
          No recent checks yet
        </div>
      {% endif %}
    </div>

    <div class="side-section">
      <h4>SYSTEM</h4>
      <div class="metric">
        <div class="metric-label">
          <span class="dot ok"></span>
          <span>API Status</span>
        </div>
        <div class="metric-value">{{ system_metrics.api_status }}</div>
      </div>
      <div class="metric">
        <div class="metric-label">
          <span>Rate Limit</span>
        </div>
        <div class="metric-value">{{ system_metrics.rate_limit }}</div>
      </div>
      <div class="metric">
        <div class="metric-label">
          <span>Response Time</span>
        </div>
        <div class="metric-value">{{ system_metrics.response_time }}</div>
      </div>
    </div>

    <div class="side-footer">© 2025 Alarif Hashem</div>
  </aside>

  <main class="content">
    {% block content %}{% endblock %}
  </main>
</div>

<script>
async function clearHistory() {
  try {
    await fetch('/clear-history', { method: 'POST' });
    location.reload();
  } catch (e) {
    console.error('Failed to clear history', e);
  }
}
</script>
</body>
</html>